<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GC-IRMS data processing example • isoprocessor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GC-IRMS data processing example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isoprocessor</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li>
  <a href="../articles/continuous_flow.html">Continuous Flow</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Processing Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gc_irms_example_carbon.html">Compound specific carbon isotope analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/isoverse/isoprocessor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>GC-IRMS data processing example</h1>
            <h3 class="subtitle">carbon isotopes in alkanes</h3>
            
            <h4 class="date">2019-05-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/isoverse/isoprocessor/blob/master/vignettes/gc_irms_example_carbon.Rmd"><code>vignettes/gc_irms_example_carbon.Rmd</code></a></small>
      <div class="hidden name"><code>gc_irms_example_carbon.Rmd</code></div>

    </div>

    
    
<div id="load-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse) <span class="co"># general data wrangling and plotting</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(isoreader) <span class="co"># reading the raw data files</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(isoprocessor) <span class="co"># processing the data</span></a></code></pre></div>
<p>This analysis was run using <a href="http://isoreader.kopflab.org">isoreader</a> version 1.0.7 and <a href="http://isoprocessor.kopflab.org/">isoprocessor</a> version 0.4.0.</p>
<p>For use as a data processing template, please follow the <code>Source</code> link above, download the raw file and adapt as needed. Knitting for stand-alone data analysis works best to <code>HTML</code> rather than the in-package default <code>html_vignette</code>.</p>
<p>All code chunks that contain a critical step towards the final data (i.e. do more than visualization or a data summary) are marked with <code>(*)</code> in the header to make it easier to follow all key steps during interactive use.</p>
</div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<div id="read-raw-data-files" class="section level2">
<h2 class="hasAnchor">
<a href="#read-raw-data-files" class="anchor"></a>Read raw data files (*)</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># set file path(s) to data files, folders or rds collections </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># can be multiple folders or mix of folders and files, using example data set here</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># (this is a reduced data set of mostly standards with just a few example samples)</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">data_path &lt;-<span class="st"> </span><span class="kw"><a href="../reference/iso_get_processor_example.html">iso_get_processor_example</a></span>(<span class="st">"gc_irms_example_carbon.cf.rds"</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># read files</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">iso_files_raw &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="st">  </span><span class="co"># path to data files</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="st">  </span>data_path <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="st">  </span><span class="co"># read data files in parallel for fast read</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_read_continuous_flow">iso_read_continuous_flow</a></span>(<span class="dt">parallel =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="st">  </span><span class="co"># filter out files with read errors (e.g. from aborted analysis)</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files_with_problems">iso_filter_files_with_problems</a></span>()</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; Info: preparing to read 1 data files (all will be cached), setting up ...</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; Info (process 1): reading file 'gc_irms_example_carbon.cf.rds' with '....</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; Info (process 1): loaded data for 47 data files from R Data Storage - ...</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; Info: finished reading 1 files in 1.20 secs</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; Info: encountered 2 problems in total</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; # A tibble: 2 x 4</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt;   file_id         type  func            details                            </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;           &lt;chr&gt;                              </span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; 1 BF2133__A5 con… error extract_dxf_ra… cannot identify measured masses - …</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; 2 BF2110__A5_0_5… error extract_dxf_ra… cannot identify measured masses - …</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; Info: removing 2/47 files that have any error (keeping 45)</span></a></code></pre></div>
</div>
<div id="process-file-information" class="section level2">
<h2 class="hasAnchor">
<a href="#process-file-information" class="anchor"></a>Process file information (*)</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># process file information</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">iso_files &lt;-<span class="st"> </span>iso_files_raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="co"># rename key file info columns</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_rename_file_info">iso_rename_file_info</a></span>(<span class="dt">id1 =</span> <span class="st">`</span><span class="dt">Identifier 1</span><span class="st">`</span>, <span class="dt">id2 =</span> <span class="st">`</span><span class="dt">Identifier 2</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="co"># parse text info into numbers</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_parse_file_info">iso_parse_file_info</a></span>(<span class="dt">number =</span> Analysis) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="co"># process other file information that is specific to the naming conventions</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span><span class="co"># of this particular sequence</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_mutate_file_info">iso_mutate_file_info</a></span>(</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    <span class="co"># what is the type of each analysis?</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    <span class="dt">type =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">      <span class="kw">str_detect</span>(id1, <span class="st">"[Zz]ero"</span>)      <span class="op">~</span><span class="st"> "on_off"</span>,</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">      <span class="kw">str_detect</span>(id1, <span class="st">"[Ll]inearity"</span>) <span class="op">~</span><span class="st"> "lin"</span>,</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">      <span class="kw">str_detect</span>(id1, <span class="st">"A5"</span>)           <span class="op">~</span><span class="st"> "std"</span>,</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">      <span class="ot">TRUE</span>                            <span class="op">~</span><span class="st"> "sample"</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">    ),</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">    <span class="co"># was there seed oxidation?</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18">    <span class="dt">seed_oxidation =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(<span class="st">`</span><span class="dt">Seed Oxidation</span><span class="st">`</span> <span class="op">==</span><span class="st"> "1"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>),</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">    <span class="co"># what was the injection volume based on the AS method name?</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">    <span class="dt">injection_volume.uL =</span> <span class="kw">str_extract</span>(<span class="st">`</span><span class="dt">AS Method</span><span class="st">`</span>, <span class="st">"AS PTV [0-9.]+"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="st">      </span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span>(),</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">    <span class="co"># what was the concentration? (assuming Preparation = concentration or volume)</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23">    <span class="dt">conc.ng_uL =</span> <span class="kw">str_extract</span>(Preparation, <span class="st">"[0-9.]+ ?ng( per |/)uL"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span>(),</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">    <span class="co"># or the volume?</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25">    <span class="dt">volume.uL =</span> <span class="kw">str_extract</span>(Preparation, <span class="st">"[0-9.]+ ?uL"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span>(),</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">    <span class="co"># what folder are the data files in? (assuming folder = sequence)</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27">    <span class="dt">folder =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">basename</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">dirname</a></span>(file_path))</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="st">  </span><span class="co"># add in additional sample metadata (could be any info)</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="st">  </span><span class="co"># note: this would typically be stored in / read from a csv or excel file</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="st">  </span><span class="kw">iso_add_file_info</span>(</a>
<a class="sourceLine" id="cb3-32" data-line-number="32">    tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</a>
<a class="sourceLine" id="cb3-33" data-line-number="33">      <span class="co"># column names</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34">      <span class="op">~</span>id1,                           <span class="op">~</span>sample,          <span class="op">~</span>fraction,</a>
<a class="sourceLine" id="cb3-35" data-line-number="35">      <span class="co"># metadata (row-by-row)</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36">      <span class="st">"OG268_CZO-SJER_F1"</span>,            <span class="st">"SJER"</span>,           <span class="st">"F1"</span>,</a>
<a class="sourceLine" id="cb3-37" data-line-number="37">      <span class="st">"OG271_CZO-CTNA_F1"</span>,            <span class="st">"CTNA"</span>,           <span class="st">"F1"</span>,</a>
<a class="sourceLine" id="cb3-38" data-line-number="38">      <span class="st">"OG281_CZO-Niwot_Tundra2_F1"</span>,   <span class="st">"Niwot_Tundra2"</span>,  <span class="st">"F1"</span>,</a>
<a class="sourceLine" id="cb3-39" data-line-number="39">      <span class="st">"OG282_CZO-Niwot_Tundra1_F1"</span>,   <span class="st">"Niwot_Tundra1"</span>,  <span class="st">"F1"</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40">    ),</a>
<a class="sourceLine" id="cb3-41" data-line-number="41">    <span class="dt">join_by =</span> <span class="st">"id1"</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="st">  </span><span class="co"># focus only on the relevant file info, discarding the rest</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_select_file_info">iso_select_file_info</a></span>(</a>
<a class="sourceLine" id="cb3-45" data-line-number="45">    folder, Analysis, file_datetime, id1, id2, type, sample, </a>
<a class="sourceLine" id="cb3-46" data-line-number="46">    seed_oxidation, injection_volume.uL, conc.ng_uL, volume.uL</a>
<a class="sourceLine" id="cb3-47" data-line-number="47">  )</a>
<a class="sourceLine" id="cb3-48" data-line-number="48"><span class="co">#&gt; Info: renaming 2 file info column(s) wherever they exist across 45 isofile(s):</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49"><span class="co">#&gt;  - 'Identifier 1' to 'id1' in 45 files</span></a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="co">#&gt;  - 'Identifier 2' to 'id2' in 44 files</span></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"><span class="co">#&gt; Info: parsing 1 file info columns for 45 data file(s):</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="co">#&gt;  - to number: 'Analysis'</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"><span class="co">#&gt; Info: mutating file info for 45 data file(s)</span></a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="co">#&gt; Info: adding new file information ('sample', 'fraction') to 45 data file(s), joining by 'id1'...</span></a>
<a class="sourceLine" id="cb3-55" data-line-number="55"><span class="co">#&gt;  - 'id1' join: 4/4 new info rows matched 4/45 data files</span></a>
<a class="sourceLine" id="cb3-56" data-line-number="56"><span class="co">#&gt; Info: keeping 12 file info column(s) wherever they exist across 45 isofile(s):</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57"><span class="co">#&gt;  - 'Analysis' in 45 files</span></a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="co">#&gt;  - 'conc.ng_uL' in 45 files</span></a>
<a class="sourceLine" id="cb3-59" data-line-number="59"><span class="co">#&gt;  - 'file_datetime' in 45 files</span></a>
<a class="sourceLine" id="cb3-60" data-line-number="60"><span class="co">#&gt;  - 'file_id' in 45 files</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61"><span class="co">#&gt;  - 'folder' in 45 files</span></a>
<a class="sourceLine" id="cb3-62" data-line-number="62"><span class="co">#&gt;  - 'id1' in 45 files</span></a>
<a class="sourceLine" id="cb3-63" data-line-number="63"><span class="co">#&gt;  - 'id2' in 45 files</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64"><span class="co">#&gt;  - 'injection_volume.uL' in 45 files</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65"><span class="co">#&gt;  - 'sample' in 45 files</span></a>
<a class="sourceLine" id="cb3-66" data-line-number="66"><span class="co">#&gt;  - 'seed_oxidation' in 45 files</span></a>
<a class="sourceLine" id="cb3-67" data-line-number="67"><span class="co">#&gt;  - 'type' in 45 files</span></a>
<a class="sourceLine" id="cb3-68" data-line-number="68"><span class="co">#&gt;  - 'volume.uL' in 45 files</span></a></code></pre></div>
</div>
<div id="show-file-information" class="section level2">
<h2 class="hasAnchor">
<a href="#show-file-information" class="anchor"></a>Show file information</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># display file information</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">iso_files <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_get_file_info">iso_get_file_info</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>file_id, <span class="op">-</span>folder) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>()</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; Info: aggregating file info from 45 data file(s)</span></a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Analysis</th>
<th align="left">file_datetime</th>
<th align="left">id1</th>
<th align="left">id2</th>
<th align="left">type</th>
<th align="left">sample</th>
<th align="left">seed_oxidation</th>
<th align="right">injection_volume.uL</th>
<th align="right">conc.ng_uL</th>
<th align="right">volume.uL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2026</td>
<td align="left">2017-10-25 20:22:23</td>
<td align="left">CO2 zero</td>
<td align="left">6V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2030</td>
<td align="left">2017-10-25 20:55:44</td>
<td align="left">Linearity CO2</td>
<td align="left">NA</td>
<td align="left">lin</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2034</td>
<td align="left">2017-10-26 03:15:48</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2041</td>
<td align="left">2017-10-26 14:50:38</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2047</td>
<td align="left">2017-10-26 23:50:04</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2061</td>
<td align="left">2017-10-27 19:29:27</td>
<td align="left">OG271_CZO-CTNA_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">CTNA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="right">2093</td>
<td align="left">2017-10-29 18:32:04</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2099</td>
<td align="left">2017-10-30 04:33:19</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2106</td>
<td align="left">2017-10-30 16:25:45</td>
<td align="left">OG281_CZO-Niwot_Tundra2_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">Niwot_Tundra2</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">150</td>
</tr>
<tr class="even">
<td align="right">2114</td>
<td align="left">2017-10-31 04:08:42</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2132</td>
<td align="left">2017-11-01 12:33:25</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2138</td>
<td align="left">2017-11-02 01:48:12</td>
<td align="left">A5 conc</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2027</td>
<td align="left">2017-10-25 20:30:42</td>
<td align="left">CO2 zero</td>
<td align="left">3V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2031</td>
<td align="left">2017-10-25 22:30:54</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2035</td>
<td align="left">2017-10-26 04:50:43</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2044</td>
<td align="left">2017-10-26 18:23:25</td>
<td align="left">A5</td>
<td align="left">4.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">4.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2053</td>
<td align="left">2017-10-27 08:49:22</td>
<td align="left">OG268_CZO-SJER_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">SJER</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">50</td>
</tr>
<tr class="even">
<td align="right">2069</td>
<td align="left">2017-10-28 06:37:31</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2096</td>
<td align="left">2017-10-29 23:48:23</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2100</td>
<td align="left">2017-10-30 06:08:16</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2107</td>
<td align="left">2017-10-30 18:00:40</td>
<td align="left">OG282_CZO-Niwot_Tundra1_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">Niwot_Tundra1</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">150</td>
</tr>
<tr class="even">
<td align="right">2115</td>
<td align="left">2017-10-31 05:43:46</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2139</td>
<td align="left">2017-11-02 09:13:36</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2028</td>
<td align="left">2017-10-25 20:39:02</td>
<td align="left">CO2 zero</td>
<td align="left">1.2V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2032</td>
<td align="left">2017-10-26 00:05:49</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2036</td>
<td align="left">2017-10-26 06:25:48</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2045</td>
<td align="left">2017-10-26 20:40:08</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2056</td>
<td align="left">2017-10-27 13:34:08</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2075</td>
<td align="left">2017-10-28 14:27:22</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2097</td>
<td align="left">2017-10-30 01:23:28</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2101</td>
<td align="left">2017-10-30 07:43:23</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2116</td>
<td align="left">2017-10-31 07:18:39</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2136</td>
<td align="left">2017-11-01 22:38:25</td>
<td align="left">A5 conc</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2140</td>
<td align="left">2017-11-02 10:48:30</td>
<td align="left">A5 conc</td>
<td align="left">2ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">2.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2029</td>
<td align="left">2017-10-25 20:47:22</td>
<td align="left">CO2 zero</td>
<td align="left">0.7V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2033</td>
<td align="left">2017-10-26 01:40:55</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2040</td>
<td align="left">2017-10-26 13:07:47</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2046</td>
<td align="left">2017-10-26 22:15:02</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2060</td>
<td align="left">2017-10-27 17:54:33</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2086</td>
<td align="left">2017-10-29 07:58:06</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2098</td>
<td align="left">2017-10-30 02:58:24</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2102</td>
<td align="left">2017-10-30 09:18:16</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2113</td>
<td align="left">2017-10-31 02:33:47</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2117</td>
<td align="left">2017-10-31 08:53:43</td>
<td align="left">A5 conc</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2137</td>
<td align="left">2017-11-02 00:13:18</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="example-chromatograms" class="section level2">
<h2 class="hasAnchor">
<a href="#example-chromatograms" class="anchor"></a>Example chromatograms</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">iso_files <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="co"># select a few analyses (these #s must exist!)</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files">iso_filter_files</a></span>(Analysis <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2046</span>, <span class="dv">2106</span>, <span class="dv">2107</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="co"># plot the chromatograms</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span>(</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    <span class="co"># select data and aesthetics</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">    <span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">44</span>), <span class="dt">color =</span> id1, <span class="dt">panel =</span> Analysis,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">    <span class="co"># zoom in on time interval</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">    <span class="dt">time_interval =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1000</span>, <span class="dv">3200</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="st">  </span><span class="co"># customize resulting ggplot</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; Info: applying file filter, keeping 3 of 45 files</span></a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/example_chromatograms-1.png" width="768"></p>
</div>
</div>
<div id="onoffs" class="section level1">
<h1 class="hasAnchor">
<a href="#onoffs" class="anchor"></a>ON/OFFs</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># find files with zero in the Identifier 1 field</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">on_offs &lt;-<span class="st"> </span>iso_files <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files">iso_filter_files</a></span>(type <span class="op">==</span><span class="st"> "on_off"</span>) </a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Info: applying file filter, keeping 4 of 45 files</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># visualize the on/offs  </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">on_offs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span>(<span class="dt">data =</span> <span class="dv">44</span>, <span class="dt">color =</span> id2)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/on_off_chromatograms-1.png" width="768"></p>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># calculate on/off summary</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">on_off_summary &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span>on_offs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="co"># retrieve data table</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_get_vendor_data_table">iso_get_vendor_data_table</a></span>(</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="dt">select =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">`</span><span class="dt">Ampl 44 [mV]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Intensity 44 [Vs]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">d 13C/12C [permil]</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">    <span class="dt">include_file_info =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(file_datetime, id2),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">    <span class="dt">with_units =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="st">  </span><span class="co"># summarize information</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="st">  </span><span class="kw">group_by</span>(file_datetime, id2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="../reference/iso_summarize_data_table.html">iso_summarize_data_table</a></span>()</a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; Info: aggregating vendor data table with units from 4 data file(s), including file info 'c(file_datetime, id2)'</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co"># table</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16">on_off_summary <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">file_datetime</th>
<th align="left">id2</th>
<th align="right">n</th>
<th align="right">Ampl 44 [mV] mean</th>
<th align="right">Ampl 44 [mV] sd</th>
<th align="right">Intensity 44 [Vs] mean</th>
<th align="right">Intensity 44 [Vs] sd</th>
<th align="right">d 13C/12C [permil] mean</th>
<th align="right">d 13C/12C [permil] sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2017-10-25 20:22:23</td>
<td align="left">6V</td>
<td align="right">10</td>
<td align="right">6090.649</td>
<td align="right">10.269</td>
<td align="right">112.848</td>
<td align="right">0.330</td>
<td align="right">0.006</td>
<td align="right">0.012</td>
</tr>
<tr class="even">
<td align="left">2017-10-25 20:30:42</td>
<td align="left">3V</td>
<td align="right">10</td>
<td align="right">3201.440</td>
<td align="right">2.561</td>
<td align="right">59.386</td>
<td align="right">0.141</td>
<td align="right">0.001</td>
<td align="right">0.018</td>
</tr>
<tr class="odd">
<td align="left">2017-10-25 20:39:02</td>
<td align="left">1.2V</td>
<td align="right">10</td>
<td align="right">1183.202</td>
<td align="right">1.075</td>
<td align="right">21.968</td>
<td align="right">0.054</td>
<td align="right">-0.006</td>
<td align="right">0.024</td>
</tr>
<tr class="even">
<td align="left">2017-10-25 20:47:22</td>
<td align="left">0.7V</td>
<td align="right">10</td>
<td align="right">681.097</td>
<td align="right">0.652</td>
<td align="right">12.638</td>
<td align="right">0.030</td>
<td align="right">-0.031</td>
<td align="right">0.052</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">on_off_summary <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="co"># use generic data plot function</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    <span class="dt">x =</span> file_datetime, <span class="dt">y =</span> <span class="st">`</span><span class="dt">d 13C/12C [permil] sd</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    <span class="dt">size =</span> <span class="st">`</span><span class="dt">Ampl 44 [mV] mean</span><span class="st">`</span>, <span class="dt">color =</span> id2,</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">    <span class="dt">points =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="st">  </span><span class="co"># customize resulting ggplot</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">  </span><span class="kw">expand_limits</span>(<span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="ot">NULL</span>, <span class="dt">date_labels =</span> <span class="st">"%b %d - %H:%M"</span>) </a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/on_off_summary-1.png" width="576"></p>
</div>
</div>
<div id="linearity" class="section level1">
<h1 class="hasAnchor">
<a href="#linearity" class="anchor"></a>Linearity</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># find files with linearity in the Identifier 1 field</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">lins &lt;-<span class="st"> </span>iso_files <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files">iso_filter_files</a></span>(type <span class="op">==</span><span class="st"> "lin"</span>) </a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; Info: applying file filter, keeping 1 of 45 files</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co"># visualize the linearity runs</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">lins <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span>(<span class="dt">data =</span> <span class="dv">44</span>, <span class="dt">color =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(file_datetime))</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/linearity_chromatograms-1.png" width="768"></p>
<div id="summary-1" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-1" class="anchor"></a>Summary</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># calculate linearity summary</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">linearity_summary &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span>lins <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="co"># retrieve data table</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_get_vendor_data_table">iso_get_vendor_data_table</a></span>(</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">    <span class="dt">select =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">`</span><span class="dt">Ampl 44 [mV]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Intensity 44 [Vs]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">d 13C/12C [permil]</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">    <span class="dt">include_file_info =</span> file_datetime,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">    <span class="dt">with_units =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="st">  </span><span class="co"># calculate linearity regression lines</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="st">  </span><span class="kw">nest</span>(<span class="op">-</span>file_datetime) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">    <span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(<span class="st">`</span><span class="dt">d 13C/12C [permil]</span><span class="st">`</span> <span class="op">~</span><span class="st"> `</span><span class="dt">Ampl 44 [mV]</span><span class="st">`</span>, <span class="dt">data =</span> .x)),</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">    <span class="dt">coefs =</span> <span class="kw">map</span>(fit, broom<span class="op">::</span>tidy)</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">  )</a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; Info: aggregating vendor data table with units from 1 data file(s), including file info 'file_datetime'</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co"># table</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19">linearity_summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span>(coefs) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="st">  </span><span class="kw">select</span>(file_datetime, term, estimate, std.error) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(term <span class="op">==</span><span class="st"> "`Ampl 44 [mV]`"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb10-24" data-line-number="24">    <span class="dt">term =</span> <span class="st">"linearity [permil/V]"</span>,</a>
<a class="sourceLine" id="cb10-25" data-line-number="25">    <span class="dt">estimate =</span> <span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">signif</a></span>(estimate, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb10-26" data-line-number="26">    <span class="dt">std.error =</span> <span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">signif</a></span>(std.error, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-27" data-line-number="27">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">file_datetime</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">2017-10-25 20:55:44</td>
<td align="left">linearity [permil/V]</td>
<td align="right">-0.017</td>
<td align="right">0.001</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">linearity_summary <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span>(data) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="co"># use generic data plot function</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">    <span class="dt">x =</span> <span class="st">`</span><span class="dt">Ampl 44 [mV]</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">d 13C/12C [permil]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    <span class="dt">color =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(file_datetime),</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    <span class="dt">points =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">  </span><span class="co"># customize with the linear fit</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_grid</span>(panel <span class="op">~</span><span class="st"> </span>file_datetime) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/linearity_summary-1.png" width="672"></p>
</div>
</div>
<div id="data-table" class="section level1">
<h1 class="hasAnchor">
<a href="#data-table" class="anchor"></a>Data table (*)</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># retrieve the peak data table</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">peak_table &lt;-<span class="st"> </span>iso_files <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="co"># focus on standards and samples only</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files">iso_filter_files</a></span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"std"</span>, <span class="st">"sample"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="co"># filter out analyses that</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span>## a) did not inject</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files">iso_filter_files</a></span>(<span class="op">!</span>Analysis <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2031</span>, <span class="dv">2040</span>, <span class="dv">2069</span>, <span class="dv">2098</span>, <span class="dv">2116</span>, <span class="dv">2138</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st">  </span>## b) had double or rogue peaks from mis-injection</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files">iso_filter_files</a></span>(<span class="op">!</span>Analysis <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2044</span>, <span class="dv">2132</span>, <span class="dv">2134</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="st">  </span><span class="co"># retrieve peak data table from vendor data</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_get_vendor_data_table">iso_get_vendor_data_table</a></span>(</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">    <span class="dt">select =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">      <span class="co"># ref peak info (which one was used to calculate raw delta values)</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14">      <span class="dt">is_ref =</span> <span class="st">`</span><span class="dt">Is Ref.?</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">      <span class="co"># retention time info</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16">      <span class="dt">rt_start =</span> Start, <span class="dt">rt =</span> Rt, <span class="dt">rt_end =</span> End,</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">      <span class="co"># peak amplitude and area info</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18">      <span class="dt">amp44.mV =</span> <span class="st">`</span><span class="dt">Ampl 44</span><span class="st">`</span>, <span class="dt">area44.Vs =</span> <span class="st">`</span><span class="dt">Intensity 44</span><span class="st">`</span>, <span class="dt">area.Vs =</span> <span class="st">`</span><span class="dt">Intensity All</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">      <span class="co"># isotopic info</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20">      <span class="dt">ratio =</span> <span class="st">`</span><span class="dt">R 45CO2/44CO2</span><span class="st">`</span>, <span class="dt">d13C =</span> <span class="st">`</span><span class="dt">d 13C/12C</span><span class="st">`</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21">    ),</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">    <span class="co"># include all file info in the data table</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23">    <span class="dt">include_file_info =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/reexports">everything</a></span>()</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">  ) </a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; Info: applying file filter, keeping 40 of 45 files</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; Info: applying file filter, keeping 34 of 40 files</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt; Info: applying file filter, keeping 32 of 34 files</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt; Info: aggregating vendor data table without units from 32 data file(s), including file info 'everything()'</span></a></code></pre></div>
</div>
<div id="peak-identification" class="section level1">
<h1 class="hasAnchor">
<a href="#peak-identification" class="anchor"></a>Peak Identification</h1>
<div id="load-peak-maps" class="section level2">
<h2 class="hasAnchor">
<a href="#load-peak-maps" class="anchor"></a>Load peak maps</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># this information is often maintained in a csv or Excel file instead</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># but generated here from scratch for demonstration purposes</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">peak_maps &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">    <span class="co"># column names -&gt; defining 2 peak maps, 'std' and 'sample' here</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">    <span class="co"># but could define an unlimited number of different maps</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">    <span class="op">~</span>compound, <span class="op">~</span>ref_nr, <span class="op">~</span><span class="st">`</span><span class="dt">rt:std</span><span class="st">`</span>,  <span class="op">~</span><span class="st">`</span><span class="dt">rt:sample</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">    <span class="co"># peak map data (row-by-row)</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">    <span class="st">"CO2"</span>,          <span class="dv">1</span>,        <span class="dv">79</span>,                 <span class="dv">79</span>,</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">    <span class="st">"CO2"</span>,          <span class="dv">2</span>,      <span class="dv">178</span>,                <span class="dv">178</span>,</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">    <span class="st">"CO2"</span>,          <span class="dv">3</span>,      <span class="dv">278</span>,                <span class="dv">278</span>,</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">    <span class="st">"CO2"</span>,          <span class="dv">4</span>,      <span class="dv">377</span>,                <span class="dv">377</span>,</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">    <span class="st">"CO2"</span>,          <span class="dv">5</span>,      <span class="dv">477</span>,                <span class="dv">477</span>,</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">    <span class="st">"CO2"</span>,          <span class="dv">6</span>,      <span class="dv">576</span>,                <span class="dv">576</span>,</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">    <span class="st">"CO2"</span>,          <span class="dv">7</span>,      <span class="dv">676</span>,                <span class="dv">676</span>,</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">    <span class="st">"CO2"</span>,          <span class="dv">8</span>,      <span class="dv">775</span>,                <span class="dv">775</span>,</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">    <span class="st">"CO2"</span>,          <span class="dv">9</span>,      <span class="dv">875</span>,                <span class="dv">875</span>,</a>
<a class="sourceLine" id="cb13-18" data-line-number="18">    <span class="st">"nC16"</span>,         <span class="ot">NA</span>,     <span class="dv">1156</span>,               <span class="dv">1156</span>,</a>
<a class="sourceLine" id="cb13-19" data-line-number="19">    <span class="st">"nC17"</span>,         <span class="ot">NA</span>,     <span class="dv">1280</span>,               <span class="dv">1280</span>,</a>
<a class="sourceLine" id="cb13-20" data-line-number="20">    <span class="st">"nC18"</span>,         <span class="ot">NA</span>,     <span class="dv">1409</span>,               <span class="dv">1409</span>,</a>
<a class="sourceLine" id="cb13-21" data-line-number="21">    <span class="st">"nC19"</span>,         <span class="ot">NA</span>,     <span class="dv">1540</span>,               <span class="dv">1540</span>,</a>
<a class="sourceLine" id="cb13-22" data-line-number="22">    <span class="st">"nC20"</span>,         <span class="ot">NA</span>,     <span class="dv">1670</span>,               <span class="dv">1670</span>,</a>
<a class="sourceLine" id="cb13-23" data-line-number="23">    <span class="st">"nC21"</span>,         <span class="ot">NA</span>,     <span class="dv">1797</span>,               <span class="dv">1797</span>,</a>
<a class="sourceLine" id="cb13-24" data-line-number="24">    <span class="st">"nC22"</span>,         <span class="ot">NA</span>,     <span class="dv">1921</span>,               <span class="dv">1921</span>,</a>
<a class="sourceLine" id="cb13-25" data-line-number="25">    <span class="st">"nC23"</span>,         <span class="ot">NA</span>,     <span class="dv">2040</span>,               <span class="dv">2040</span>,</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">    <span class="st">"nC24"</span>,         <span class="ot">NA</span>,     <span class="dv">2156</span>,               <span class="dv">2156</span>,</a>
<a class="sourceLine" id="cb13-27" data-line-number="27">    <span class="st">"nC25"</span>,         <span class="ot">NA</span>,     <span class="dv">2267</span>,               <span class="dv">2267</span>,</a>
<a class="sourceLine" id="cb13-28" data-line-number="28">    <span class="st">"nC26"</span>,         <span class="ot">NA</span>,     <span class="dv">2375</span>,               <span class="dv">2375</span>,</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">    <span class="st">"nC27"</span>,         <span class="ot">NA</span>,     <span class="dv">2479</span>,               <span class="dv">2479</span>,</a>
<a class="sourceLine" id="cb13-30" data-line-number="30">    <span class="st">"nC28"</span>,         <span class="ot">NA</span>,     <span class="dv">2580</span>,               <span class="dv">2580</span>,</a>
<a class="sourceLine" id="cb13-31" data-line-number="31">    <span class="st">"nC29"</span>,         <span class="ot">NA</span>,     <span class="dv">2674</span>,               <span class="dv">2678</span>,</a>
<a class="sourceLine" id="cb13-32" data-line-number="32">    <span class="st">"nC30"</span>,         <span class="ot">NA</span>,     <span class="dv">2770</span>,               <span class="dv">2773</span>,</a>
<a class="sourceLine" id="cb13-33" data-line-number="33">    <span class="st">"nC31"</span>,         <span class="ot">NA</span>,     <span class="ot">NA</span>,               <span class="dv">2863</span>,</a>
<a class="sourceLine" id="cb13-34" data-line-number="34">    <span class="st">"CO2"</span>,          <span class="dv">10</span>,     <span class="dv">3552</span>,               <span class="dv">3552</span>,</a>
<a class="sourceLine" id="cb13-35" data-line-number="35">    <span class="st">"CO2"</span>,          <span class="dv">11</span>,     <span class="dv">3592</span>,               <span class="dv">3592</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36">  )</a>
<a class="sourceLine" id="cb13-37" data-line-number="37">peak_maps <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">0</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">compound</th>
<th align="right">ref_nr</th>
<th align="right">rt:std</th>
<th align="right">rt:sample</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">1</td>
<td align="right">79</td>
<td align="right">79</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">2</td>
<td align="right">178</td>
<td align="right">178</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">3</td>
<td align="right">278</td>
<td align="right">278</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">4</td>
<td align="right">377</td>
<td align="right">377</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">5</td>
<td align="right">477</td>
<td align="right">477</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">6</td>
<td align="right">576</td>
<td align="right">576</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">7</td>
<td align="right">676</td>
<td align="right">676</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">8</td>
<td align="right">775</td>
<td align="right">775</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">9</td>
<td align="right">875</td>
<td align="right">875</td>
</tr>
<tr class="even">
<td align="left">nC16</td>
<td align="right">NA</td>
<td align="right">1156</td>
<td align="right">1156</td>
</tr>
<tr class="odd">
<td align="left">nC17</td>
<td align="right">NA</td>
<td align="right">1280</td>
<td align="right">1280</td>
</tr>
<tr class="even">
<td align="left">nC18</td>
<td align="right">NA</td>
<td align="right">1409</td>
<td align="right">1409</td>
</tr>
<tr class="odd">
<td align="left">nC19</td>
<td align="right">NA</td>
<td align="right">1540</td>
<td align="right">1540</td>
</tr>
<tr class="even">
<td align="left">nC20</td>
<td align="right">NA</td>
<td align="right">1670</td>
<td align="right">1670</td>
</tr>
<tr class="odd">
<td align="left">nC21</td>
<td align="right">NA</td>
<td align="right">1797</td>
<td align="right">1797</td>
</tr>
<tr class="even">
<td align="left">nC22</td>
<td align="right">NA</td>
<td align="right">1921</td>
<td align="right">1921</td>
</tr>
<tr class="odd">
<td align="left">nC23</td>
<td align="right">NA</td>
<td align="right">2040</td>
<td align="right">2040</td>
</tr>
<tr class="even">
<td align="left">nC24</td>
<td align="right">NA</td>
<td align="right">2156</td>
<td align="right">2156</td>
</tr>
<tr class="odd">
<td align="left">nC25</td>
<td align="right">NA</td>
<td align="right">2267</td>
<td align="right">2267</td>
</tr>
<tr class="even">
<td align="left">nC26</td>
<td align="right">NA</td>
<td align="right">2375</td>
<td align="right">2375</td>
</tr>
<tr class="odd">
<td align="left">nC27</td>
<td align="right">NA</td>
<td align="right">2479</td>
<td align="right">2479</td>
</tr>
<tr class="even">
<td align="left">nC28</td>
<td align="right">NA</td>
<td align="right">2580</td>
<td align="right">2580</td>
</tr>
<tr class="odd">
<td align="left">nC29</td>
<td align="right">NA</td>
<td align="right">2674</td>
<td align="right">2678</td>
</tr>
<tr class="even">
<td align="left">nC30</td>
<td align="right">NA</td>
<td align="right">2770</td>
<td align="right">2773</td>
</tr>
<tr class="odd">
<td align="left">nC31</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">2863</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">10</td>
<td align="right">3552</td>
<td align="right">3552</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">11</td>
<td align="right">3592</td>
<td align="right">3592</td>
</tr>
</tbody>
</table>
</div>
<div id="identify-peaks" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-peaks" class="anchor"></a>Identify peaks (*)</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># get all data vendor data table, map peaks, calculate averages, add known dDs</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">peak_table_w_ids &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span>peak_table <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="co"># map peaks</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/iso_map_peaks.html">iso_map_peaks</a></span>(</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">    <span class="co"># provide peak maps</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7">    <span class="dt">peak_maps =</span> peak_maps,</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">    <span class="co"># specify which file info columns identify an individual file</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">    <span class="dt">file_id =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(file_id, Analysis),</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">    <span class="co"># specify which file info column identifies the peak map to use for each file</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">    <span class="dt">map_id =</span> type</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">  ) </a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; Info: 829 of 973 peaks in 32 files were successfully mapped using 2 peak maps ('std', 'sample'). 144 peak(s) could not be mapped. 7 expected peak(s) are missing.</span></a></code></pre></div>
</div>
<div id="inspect-peak-mappings" class="section level2">
<h2 class="hasAnchor">
<a href="#inspect-peak-mappings" class="anchor"></a>Inspect peak mappings</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># use same plotting as earlier, except now with peak features added in</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">iso_files <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">  </span><span class="co"># select the example chromatograms again</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/iso_filter_files">iso_filter_files</a></span>(Analysis <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2046</span>, <span class="dv">2106</span>, <span class="dv">2107</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span>(</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    <span class="co"># select data and aesthetics</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">    <span class="dt">data =</span> <span class="dv">44</span>, <span class="dt">color =</span> id1, <span class="dt">panel =</span> Analysis,</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">    <span class="co"># zoom in on time interval</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9">    <span class="dt">time_interval =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1000</span>, <span class="dv">3200</span>),</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">    <span class="co"># provide peak table information</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">    <span class="dt">peak_table =</span> peak_table_w_ids, </a>
<a class="sourceLine" id="cb15-12" data-line-number="12">    <span class="co"># define peak labels, this can be any valid expression</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13">    <span class="dt">peak_label =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(peak_info, <span class="st">"</span><span class="ch">\n</span><span class="st">d13C="</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(d13C, <span class="dv">1</span>)), </a>
<a class="sourceLine" id="cb15-14" data-line-number="14">    <span class="co"># specify which labels to show (removing the !is_identified or putting a </span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15">    <span class="co"># restriction by retention time can help a lot with busy chromatograms)</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16">    <span class="dt">peak_label_filter =</span> is_identified <span class="op">|</span><span class="st"> </span><span class="op">!</span>is_identified <span class="op">|</span><span class="st"> </span>is_missing</a>
<a class="sourceLine" id="cb15-17" data-line-number="17">  )  <span class="op">+</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="st">  </span><span class="co"># customize resulting ggplot</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co">#&gt; Info: applying file filter, keeping 3 of 45 files</span></a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/example_chromatograms_with_peaks-1.png" width="768"></p>
</div>
<div id="overview-of-unclear-peak-mappings" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-unclear-peak-mappings" class="anchor"></a>Overview of unclear peak mappings</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># look at missing and unidentified peaks summary (not run during knitting)</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># -&gt; check if any of the missing peaks are unexpected (should be there but aren't)</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co"># -&gt; check if any unidentified peaks should be added to the peak maps</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co"># -&gt; check if any ambiguous peaks need clearer peak map retention times</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># when in doubt, look at the chromatograms of the problematic files!</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co"># as needed: iterate on peak map update, then peak mapping inspection</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">peak_table_w_ids <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="../reference/iso_get_problematic_peak_mappings.html">iso_get_problematic_peak_mappings</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="../reference/iso_summarize_peak_mappings.html">iso_summarize_peak_mappings</a></span>(<span class="dt">file_id =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(Analysis, type))</a></code></pre></div>
</div>
</div>
<div id="reference-peaks" class="section level1">
<h1 class="hasAnchor">
<a href="#reference-peaks" class="anchor"></a>Reference peaks</h1>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># examine variation in the reference peaks</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">peak_table_w_ids <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="st">  </span><span class="co"># focus on reference peaks only</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(ref_nr)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="st">  </span><span class="co"># mark ref peak used for raw delta values (assuming the same in all anlysis)</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ref_info =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(ref_nr, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(is_ref <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">"*"</span>, <span class="st">""</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="st">           </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fct_inorder</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="st">  </span><span class="co"># calculate deviations from average measured ratio in each file</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(file_id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">delta_vs_avg =</span> (ratio <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(ratio) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="st">  </span><span class="co"># visualize</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="st">  </span><span class="kw">aes</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(Analysis), delta_vs_avg, <span class="dt">fill =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(ref_info)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">position =</span> <span class="st">"dodge"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb17-18" data-line-number="18">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">hjust =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Analysis"</span>, <span class="dt">y =</span> <span class="st">"Deviation from run average (permil)"</span>, </a>
<a class="sourceLine" id="cb17-20" data-line-number="20">       <span class="dt">color =</span> <span class="st">"Reference</span><span class="ch">\n</span><span class="st">peak"</span>, <span class="dt">fill =</span> <span class="st">"Reference</span><span class="ch">\n</span><span class="st">peak"</span>) <span class="co"># +</span></a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/ref_peak_variation-1.png" width="960"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">  ## optional addition: panel by folder/seq</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  <span class="co"># facet_grid(. ~ folder, scale = "free_x", space = "free_x")</span></a></code></pre></div>
</div>
<div id="analyte-peaks" class="section level1">
<h1 class="hasAnchor">
<a href="#analyte-peaks" class="anchor"></a>Analyte peaks</h1>
<div id="select-analyte-peaks" class="section level2">
<h2 class="hasAnchor">
<a href="#select-analyte-peaks" class="anchor"></a>Select analyte peaks (*)</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># focus on analyte peaks and calculate useful summary statistics</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">peak_table_analytes &lt;-<span class="st"> </span>peak_table_w_ids <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="co"># omit reference peaks for further processing (i.e. analyte peaks only)</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(ref_nr)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">  </span><span class="co"># for each analysis, calculate a few useful summary statistics</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(file_id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">   <span class="co"># calculate relative area for individual peaks</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9">    <span class="dt">rel_area =</span> area.Vs <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(area.Vs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb19-10" data-line-number="10">    <span class="co"># calculate mean area for all peaks</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11">    <span class="dt">mean_area.Vs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(area.Vs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">    <span class="co"># calculate mean area and amplitude for identified peaks</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">    <span class="dt">mean_area_identified.Vs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(area.Vs[<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(compound)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb19-14" data-line-number="14">    <span class="dt">mean_amp_identified.mV =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(amp44.mV[<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(compound)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="st">  </span><span class="kw">ungroup</span>()</a></code></pre></div>
</div>
<div id="first-look" class="section level2">
<h2 class="hasAnchor">
<a href="#first-look" class="anchor"></a>First look</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">peak_table_analytes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(compound)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="co"># visualize with convenience function iso_plot_data</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">    <span class="co"># choose x and y (multiple y possible)</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7">    <span class="dt">x =</span> area.Vs, <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(amp44.mV, d13C),</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">    <span class="co"># choose aesthetics</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9">    <span class="dt">color =</span> compound, <span class="dt">shape =</span> type, <span class="dt">label =</span> compound, <span class="dt">size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb20-10" data-line-number="10">    <span class="co"># decide what geoms to include</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11">    <span class="dt">points =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="st">  </span><span class="co"># further customize ggplot with a log scale x axis</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_x_log10</span>()</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/first_look_sample_and_standard_peaks-1.png" width="672"></p>
</div>
<div id="optionally---use-interactive-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#optionally---use-interactive-plot" class="anchor"></a>Optionally - use interactive plot</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># optinally, use an interactive plot to explore your data</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># - make sure you install the plotly library --&gt; install.packages("plotly")</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co"># - switch to eval=TRUE in the options of this chunk to include in knit</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co"># - this should work for all plots in this example processing file</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(plotly)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/ggplotly">ggplotly</a></span>(<span class="dt">dynamicTicks =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="evaluate-signal-yield" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluate-signal-yield" class="anchor"></a>Evaluate signal yield</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># evaluate yield</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co"># (only makes sense if both injection volume and concentration are available)</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">peak_table_analytes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="co"># focus on standards</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(type <span class="op">==</span><span class="st"> "std"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">  </span><span class="co"># calculate injection amount</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">mutate</a></span>(<span class="dt">injection.ng =</span> injection_volume.uL <span class="op">*</span><span class="st"> </span>conc.ng_uL) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">  </span><span class="co"># visualize</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb22-10" data-line-number="10">    <span class="co"># x and y</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11">    <span class="dt">x =</span> injection.ng, <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(mean_area_identified.Vs, mean_amp_identified.mV),</a>
<a class="sourceLine" id="cb22-12" data-line-number="12">    <span class="co"># aesthetics</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13">    <span class="dt">color =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(injection_volume.uL), <span class="dt">shape =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(conc.ng_uL), <span class="dt">size =</span> file_datetime,</a>
<a class="sourceLine" id="cb22-14" data-line-number="14">    <span class="dt">points =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="st">  </span><span class="co"># modify plot with trendline and axis limits</span></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> <span class="ot">NULL</span>, <span class="dt">shape =</span> <span class="ot">NULL</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18"><span class="st">  </span><span class="kw">expand_limits</span>(<span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">x =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/yield-1.png" width="672"></p>
</div>
</div>
<div id="isotope-standard-values" class="section level1">
<h1 class="hasAnchor">
<a href="#isotope-standard-values" class="anchor"></a>Isotope standard values</h1>
<div id="load-isotope-standards" class="section level2">
<h2 class="hasAnchor">
<a href="#load-isotope-standards" class="anchor"></a>Load isotope standards</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># this information is often maintained in a csv or Excel file instead</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co"># but generated here from scratch for demonstration purposes</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">standards &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">    <span class="op">~</span>compound,   <span class="op">~</span>true_d13C,</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">    <span class="st">"nC16"</span>,         <span class="fl">-26.15</span>,</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">    <span class="st">"nC17"</span>,         <span class="fl">-31.88</span>,</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">    <span class="st">"nC18"</span>,         <span class="fl">-32.70</span>,</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">    <span class="st">"nC19"</span>,         <span class="fl">-31.99</span>,</a>
<a class="sourceLine" id="cb23-10" data-line-number="10">    <span class="st">"nC20"</span>,         <span class="fl">-33.97</span>,</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">    <span class="st">"nC21"</span>,         <span class="fl">-28.83</span>,</a>
<a class="sourceLine" id="cb23-12" data-line-number="12">    <span class="st">"nC22"</span>,         <span class="fl">-33.77</span>,</a>
<a class="sourceLine" id="cb23-13" data-line-number="13">    <span class="st">"nC23"</span>,         <span class="fl">-33.37</span>,</a>
<a class="sourceLine" id="cb23-14" data-line-number="14">    <span class="st">"nC24"</span>,         <span class="fl">-32.13</span>,</a>
<a class="sourceLine" id="cb23-15" data-line-number="15">    <span class="st">"nC25"</span>,         <span class="fl">-28.46</span>,</a>
<a class="sourceLine" id="cb23-16" data-line-number="16">    <span class="st">"nC26"</span>,         <span class="fl">-32.94</span>,</a>
<a class="sourceLine" id="cb23-17" data-line-number="17">    <span class="st">"nC27"</span>,         <span class="fl">-30.49</span>,</a>
<a class="sourceLine" id="cb23-18" data-line-number="18">    <span class="st">"nC28"</span>,         <span class="fl">-33.20</span>,</a>
<a class="sourceLine" id="cb23-19" data-line-number="19">    <span class="st">"nC29"</span>,         <span class="fl">-29.10</span>,</a>
<a class="sourceLine" id="cb23-20" data-line-number="20">    <span class="st">"nC30"</span>,         <span class="fl">-29.84</span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21">  ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">mutate</a></span>(<span class="dt">type =</span> <span class="st">"std"</span>)</a>
<a class="sourceLine" id="cb23-22" data-line-number="22">standards <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">compound</th>
<th align="right">true_d13C</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nC16</td>
<td align="right">-26.15</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC17</td>
<td align="right">-31.88</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC18</td>
<td align="right">-32.70</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC19</td>
<td align="right">-31.99</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC20</td>
<td align="right">-33.97</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC21</td>
<td align="right">-28.83</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC22</td>
<td align="right">-33.77</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC23</td>
<td align="right">-33.37</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC24</td>
<td align="right">-32.13</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC25</td>
<td align="right">-28.46</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC26</td>
<td align="right">-32.94</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC27</td>
<td align="right">-30.49</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC28</td>
<td align="right">-33.20</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC29</td>
<td align="right">-29.10</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC30</td>
<td align="right">-29.84</td>
<td align="left">std</td>
</tr>
</tbody>
</table>
</div>
<div id="add-isotope-standards" class="section level2">
<h2 class="hasAnchor">
<a href="#add-isotope-standards" class="anchor"></a>Add isotope standards (*)</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">peak_table_w_stds &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span>peak_table_analytes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/iso_add_standards.html">iso_add_standards</a></span>(<span class="dt">stds =</span> standards, <span class="dt">match_by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"type"</span>, <span class="st">"compound"</span>)) </a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; Info: matching standards by 'type' and 'compound' - added 15 standard entries to 420 out of 628 rows, added new column 'is_std_peak' to identify standard peaks</span></a></code></pre></div>
</div>
</div>
<div id="calibration" class="section level1">
<h1 class="hasAnchor">
<a href="#calibration" class="anchor"></a>Calibration</h1>
<div id="single-analysis-calibration-for-qa" class="section level2">
<h2 class="hasAnchor">
<a href="#single-analysis-calibration-for-qa" class="anchor"></a>Single analysis calibration (for QA)</h2>
<div id="generate-calibrations" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-calibrations" class="anchor"></a>Generate calibrations</h3>
<p>Determine calibrations fits for all individual standard analyses.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">stds_w_calibs &lt;-<span class="st"> </span>peak_table_w_stds <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="co"># focus on standards</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(type <span class="op">==</span><span class="st"> "std"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="co"># remove unassigned peaks</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/iso_remove_problematic_peak_mappings.html">iso_remove_problematic_peak_mappings</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="st">  </span><span class="co"># prepare for calibration by defining the grouping column(s) </span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span>(<span class="dt">group_by =</span> Analysis) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="st">  </span><span class="co"># run calibration</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span>(<span class="dt">model =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(d13C <span class="op">~</span><span class="st"> </span>true_d13C)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="st">  </span><span class="co"># unnest some useful file information for visualization</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="../reference/iso_unnest_data.html">iso_unnest_data</a></span>(</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">    <span class="dt">select =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(file_datetime, injection_volume.uL, seed_oxidation, mean_area_identified.Vs))</a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="co">#&gt; Info: removing 6 of 426 data table entries because of problematic peak identifications (unidentified, missing or ambiguous)</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="co">#&gt; Info: preparing data for calibration by grouping based on 'Analysis'</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="co">#&gt; Info: generating calibration based on 1 model ('lm(d13C ~ true_d13C)') for 28 data group(s) with standards filter 'is_std_peak'. Storing residuals in new column 'resid'. Storing calibration info in new column 'in_calib'.</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="co"># check for problematic calibrations</span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18">stds_w_calibs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/iso_get_problematic_calibrations.html">iso_get_problematic_calibrations</a></span>() -&gt;<span class="st"> </span>problematic.calibs</a>
<a class="sourceLine" id="cb25-19" data-line-number="19"><span class="co">#&gt; Info: there were no problematic calibrations</span></a>
<a class="sourceLine" id="cb25-20" data-line-number="20"><span class="co"># View(problematic.calibs)</span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="co"># move forward only with good calibrations</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23">stds_w_calibs &lt;-<span class="st"> </span>stds_w_calibs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/iso_remove_problematic_calibrations.html">iso_remove_problematic_calibrations</a></span>()</a></code></pre></div>
</div>
<div id="coefficients" class="section level3">
<h3 class="hasAnchor">
<a href="#coefficients" class="anchor"></a>Coefficients</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># look at coefficients and summary</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">stds_w_calibs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="st">  </span><span class="co"># unnest calibration parameters</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/iso_unnest_calibration_parameters.html">iso_unnest_calibration_parameters</a></span>(</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">    <span class="dt">select_from_coefs =</span> </a>
<a class="sourceLine" id="cb26-6" data-line-number="6">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(term, estimate, <span class="dt">SE =</span> std.error, signif),</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">    <span class="dt">select_from_summary =</span> </a>
<a class="sourceLine" id="cb26-8" data-line-number="8">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">fit_R2 =</span> adj.r.squared, <span class="dt">fit_RMSD =</span> deviance, <span class="dt">residual_df =</span> df.residual)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="../reference/iso_remove_list_columns.html">iso_remove_list_columns</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">arrange</a></span>(term) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Analysis</th>
<th align="left">calib</th>
<th align="left">file_datetime</th>
<th align="left">seed_oxidation</th>
<th align="right">injection_volume.uL</th>
<th align="right">mean_area_identified.Vs</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="left">signif</th>
<th align="right">fit_R2</th>
<th align="right">fit_RMSD</th>
<th align="right">residual_df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2032</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 00:05:49</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.2615</td>
<td align="left">(Intercept)</td>
<td align="right">11.2381</td>
<td align="right">0.3698</td>
<td align="left">***</td>
<td align="right">0.9981</td>
<td align="right">0.1368</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2033</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 01:40:55</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">13.8194</td>
<td align="left">(Intercept)</td>
<td align="right">11.0859</td>
<td align="right">0.4703</td>
<td align="left">***</td>
<td align="right">0.9969</td>
<td align="right">0.2212</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2034</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 03:15:48</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.8254</td>
<td align="left">(Intercept)</td>
<td align="right">11.2671</td>
<td align="right">0.9756</td>
<td align="left">***</td>
<td align="right">0.9870</td>
<td align="right">0.9521</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2035</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 04:50:43</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.4256</td>
<td align="left">(Intercept)</td>
<td align="right">10.8131</td>
<td align="right">0.4285</td>
<td align="left">***</td>
<td align="right">0.9974</td>
<td align="right">0.1837</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2036</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 06:25:48</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14.2196</td>
<td align="left">(Intercept)</td>
<td align="right">10.8792</td>
<td align="right">0.3646</td>
<td align="left">***</td>
<td align="right">0.9981</td>
<td align="right">0.1330</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2041</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 14:50:38</td>
<td align="left">no</td>
<td align="right">3.0</td>
<td align="right">14.8699</td>
<td align="left">(Intercept)</td>
<td align="right">10.3123</td>
<td align="right">3.0026</td>
<td align="left">**</td>
<td align="right">0.8869</td>
<td align="right">9.0195</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2045</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 20:40:08</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.4771</td>
<td align="left">(Intercept)</td>
<td align="right">10.8889</td>
<td align="right">0.6412</td>
<td align="left">***</td>
<td align="right">0.9943</td>
<td align="right">0.4113</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2046</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 22:15:02</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">9.9667</td>
<td align="left">(Intercept)</td>
<td align="right">11.1801</td>
<td align="right">0.4632</td>
<td align="left">***</td>
<td align="right">0.9970</td>
<td align="right">0.2147</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2047</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 23:50:04</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">19.1787</td>
<td align="left">(Intercept)</td>
<td align="right">11.2081</td>
<td align="right">0.3546</td>
<td align="left">***</td>
<td align="right">0.9983</td>
<td align="right">0.1258</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2056</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-27 13:34:08</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">20.4067</td>
<td align="left">(Intercept)</td>
<td align="right">11.0069</td>
<td align="right">0.3724</td>
<td align="left">***</td>
<td align="right">0.9981</td>
<td align="right">0.1387</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2060</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-27 17:54:33</td>
<td align="left">no</td>
<td align="right">1.0</td>
<td align="right">47.1479</td>
<td align="left">(Intercept)</td>
<td align="right">11.4129</td>
<td align="right">0.8419</td>
<td align="left">***</td>
<td align="right">0.9904</td>
<td align="right">0.7091</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2075</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-28 14:27:22</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">8.3326</td>
<td align="left">(Intercept)</td>
<td align="right">11.2325</td>
<td align="right">0.3605</td>
<td align="left">***</td>
<td align="right">0.9982</td>
<td align="right">0.1300</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2086</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-29 07:58:06</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">9.7230</td>
<td align="left">(Intercept)</td>
<td align="right">11.1096</td>
<td align="right">0.1856</td>
<td align="left">***</td>
<td align="right">0.9995</td>
<td align="right">0.0345</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2093</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-29 18:32:04</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.8175</td>
<td align="left">(Intercept)</td>
<td align="right">12.0237</td>
<td align="right">0.6659</td>
<td align="left">***</td>
<td align="right">0.9941</td>
<td align="right">0.4436</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2096</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-29 23:48:23</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">12.2762</td>
<td align="left">(Intercept)</td>
<td align="right">11.2949</td>
<td align="right">0.2081</td>
<td align="left">***</td>
<td align="right">0.9994</td>
<td align="right">0.0433</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2097</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 01:23:28</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">23.1567</td>
<td align="left">(Intercept)</td>
<td align="right">11.3383</td>
<td align="right">0.2171</td>
<td align="left">***</td>
<td align="right">0.9993</td>
<td align="right">0.0472</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2099</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 04:33:19</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">3.4620</td>
<td align="left">(Intercept)</td>
<td align="right">10.3700</td>
<td align="right">0.5911</td>
<td align="left">***</td>
<td align="right">0.9949</td>
<td align="right">0.3495</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2100</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 06:08:16</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">13.6752</td>
<td align="left">(Intercept)</td>
<td align="right">11.1531</td>
<td align="right">0.1618</td>
<td align="left">***</td>
<td align="right">0.9996</td>
<td align="right">0.0262</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2101</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 07:43:23</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">26.5336</td>
<td align="left">(Intercept)</td>
<td align="right">11.0189</td>
<td align="right">0.1998</td>
<td align="left">***</td>
<td align="right">0.9994</td>
<td align="right">0.0399</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2102</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 09:18:16</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">62.7400</td>
<td align="left">(Intercept)</td>
<td align="right">10.7432</td>
<td align="right">0.4240</td>
<td align="left">***</td>
<td align="right">0.9974</td>
<td align="right">0.1798</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2113</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 02:33:47</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.9775</td>
<td align="left">(Intercept)</td>
<td align="right">11.5001</td>
<td align="right">1.0634</td>
<td align="left">***</td>
<td align="right">0.9846</td>
<td align="right">1.1312</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2114</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 04:08:42</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.8675</td>
<td align="left">(Intercept)</td>
<td align="right">11.3763</td>
<td align="right">0.3359</td>
<td align="left">***</td>
<td align="right">0.9984</td>
<td align="right">0.1129</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2115</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 05:43:46</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">15.0260</td>
<td align="left">(Intercept)</td>
<td align="right">11.2240</td>
<td align="right">0.1824</td>
<td align="left">***</td>
<td align="right">0.9995</td>
<td align="right">0.0333</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2117</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 08:53:43</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">120.6737</td>
<td align="left">(Intercept)</td>
<td align="right">9.7739</td>
<td align="right">1.1193</td>
<td align="left">***</td>
<td align="right">0.9815</td>
<td align="right">1.2534</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2136</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-01 22:38:25</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">13.4564</td>
<td align="left">(Intercept)</td>
<td align="right">10.9667</td>
<td align="right">0.1148</td>
<td align="left">***</td>
<td align="right">0.9998</td>
<td align="right">0.0132</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2137</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-02 00:13:18</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">33.9905</td>
<td align="left">(Intercept)</td>
<td align="right">11.3123</td>
<td align="right">0.1869</td>
<td align="left">***</td>
<td align="right">0.9995</td>
<td align="right">0.0350</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2139</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-02 09:13:36</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">40.8236</td>
<td align="left">(Intercept)</td>
<td align="right">11.2577</td>
<td align="right">0.2570</td>
<td align="left">***</td>
<td align="right">0.9991</td>
<td align="right">0.0661</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2140</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-02 10:48:30</td>
<td align="left">yes</td>
<td align="right">2.0</td>
<td align="right">81.1947</td>
<td align="left">(Intercept)</td>
<td align="right">10.7605</td>
<td align="right">0.1660</td>
<td align="left">***</td>
<td align="right">0.9996</td>
<td align="right">0.0276</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2032</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 00:05:49</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.2615</td>
<td align="left">true_d13C</td>
<td align="right">1.0118</td>
<td align="right">0.0118</td>
<td align="left">***</td>
<td align="right">0.9981</td>
<td align="right">0.1368</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2033</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 01:40:55</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">13.8194</td>
<td align="left">true_d13C</td>
<td align="right">1.0076</td>
<td align="right">0.0150</td>
<td align="left">***</td>
<td align="right">0.9969</td>
<td align="right">0.2212</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2034</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 03:15:48</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.8254</td>
<td align="left">true_d13C</td>
<td align="right">1.0145</td>
<td align="right">0.0311</td>
<td align="left">***</td>
<td align="right">0.9870</td>
<td align="right">0.9521</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2035</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 04:50:43</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.4256</td>
<td align="left">true_d13C</td>
<td align="right">0.9995</td>
<td align="right">0.0137</td>
<td align="left">***</td>
<td align="right">0.9974</td>
<td align="right">0.1837</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2036</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 06:25:48</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14.2196</td>
<td align="left">true_d13C</td>
<td align="right">1.0001</td>
<td align="right">0.0116</td>
<td align="left">***</td>
<td align="right">0.9981</td>
<td align="right">0.1330</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2041</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 14:50:38</td>
<td align="left">no</td>
<td align="right">3.0</td>
<td align="right">14.8699</td>
<td align="left">true_d13C</td>
<td align="right">1.0085</td>
<td align="right">0.0958</td>
<td align="left">***</td>
<td align="right">0.8869</td>
<td align="right">9.0195</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2045</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 20:40:08</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.4771</td>
<td align="left">true_d13C</td>
<td align="right">1.0076</td>
<td align="right">0.0205</td>
<td align="left">***</td>
<td align="right">0.9943</td>
<td align="right">0.4113</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2046</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 22:15:02</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">9.9667</td>
<td align="left">true_d13C</td>
<td align="right">1.0137</td>
<td align="right">0.0148</td>
<td align="left">***</td>
<td align="right">0.9970</td>
<td align="right">0.2147</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2047</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-26 23:50:04</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">19.1787</td>
<td align="left">true_d13C</td>
<td align="right">1.0137</td>
<td align="right">0.0113</td>
<td align="left">***</td>
<td align="right">0.9983</td>
<td align="right">0.1258</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2056</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-27 13:34:08</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">20.4067</td>
<td align="left">true_d13C</td>
<td align="right">1.0071</td>
<td align="right">0.0119</td>
<td align="left">***</td>
<td align="right">0.9981</td>
<td align="right">0.1387</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2060</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-27 17:54:33</td>
<td align="left">no</td>
<td align="right">1.0</td>
<td align="right">47.1479</td>
<td align="left">true_d13C</td>
<td align="right">1.0217</td>
<td align="right">0.0269</td>
<td align="left">***</td>
<td align="right">0.9904</td>
<td align="right">0.7091</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2075</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-28 14:27:22</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">8.3326</td>
<td align="left">true_d13C</td>
<td align="right">1.0133</td>
<td align="right">0.0115</td>
<td align="left">***</td>
<td align="right">0.9982</td>
<td align="right">0.1300</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2086</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-29 07:58:06</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">9.7230</td>
<td align="left">true_d13C</td>
<td align="right">1.0049</td>
<td align="right">0.0059</td>
<td align="left">***</td>
<td align="right">0.9995</td>
<td align="right">0.0345</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2093</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-29 18:32:04</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.8175</td>
<td align="left">true_d13C</td>
<td align="right">1.0366</td>
<td align="right">0.0213</td>
<td align="left">***</td>
<td align="right">0.9941</td>
<td align="right">0.4436</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2096</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-29 23:48:23</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">12.2762</td>
<td align="left">true_d13C</td>
<td align="right">1.0110</td>
<td align="right">0.0066</td>
<td align="left">***</td>
<td align="right">0.9994</td>
<td align="right">0.0433</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2097</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 01:23:28</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">23.1567</td>
<td align="left">true_d13C</td>
<td align="right">1.0123</td>
<td align="right">0.0069</td>
<td align="left">***</td>
<td align="right">0.9993</td>
<td align="right">0.0472</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2099</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 04:33:19</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">3.4620</td>
<td align="left">true_d13C</td>
<td align="right">0.9830</td>
<td align="right">0.0189</td>
<td align="left">***</td>
<td align="right">0.9949</td>
<td align="right">0.3495</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2100</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 06:08:16</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">13.6752</td>
<td align="left">true_d13C</td>
<td align="right">1.0066</td>
<td align="right">0.0052</td>
<td align="left">***</td>
<td align="right">0.9996</td>
<td align="right">0.0262</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2101</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 07:43:23</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">26.5336</td>
<td align="left">true_d13C</td>
<td align="right">1.0020</td>
<td align="right">0.0064</td>
<td align="left">***</td>
<td align="right">0.9994</td>
<td align="right">0.0399</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2102</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-30 09:18:16</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">62.7400</td>
<td align="left">true_d13C</td>
<td align="right">0.9978</td>
<td align="right">0.0135</td>
<td align="left">***</td>
<td align="right">0.9974</td>
<td align="right">0.1798</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2113</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 02:33:47</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.9775</td>
<td align="left">true_d13C</td>
<td align="right">1.0174</td>
<td align="right">0.0339</td>
<td align="left">***</td>
<td align="right">0.9846</td>
<td align="right">1.1312</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2114</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 04:08:42</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.8675</td>
<td align="left">true_d13C</td>
<td align="right">1.0121</td>
<td align="right">0.0107</td>
<td align="left">***</td>
<td align="right">0.9984</td>
<td align="right">0.1129</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2115</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 05:43:46</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">15.0260</td>
<td align="left">true_d13C</td>
<td align="right">1.0082</td>
<td align="right">0.0058</td>
<td align="left">***</td>
<td align="right">0.9995</td>
<td align="right">0.0333</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2117</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-10-31 08:53:43</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">120.6737</td>
<td align="left">true_d13C</td>
<td align="right">0.9734</td>
<td align="right">0.0357</td>
<td align="left">***</td>
<td align="right">0.9815</td>
<td align="right">1.2534</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2136</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-01 22:38:25</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">13.4564</td>
<td align="left">true_d13C</td>
<td align="right">1.0030</td>
<td align="right">0.0037</td>
<td align="left">***</td>
<td align="right">0.9998</td>
<td align="right">0.0132</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2137</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-02 00:13:18</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">33.9905</td>
<td align="left">true_d13C</td>
<td align="right">1.0120</td>
<td align="right">0.0060</td>
<td align="left">***</td>
<td align="right">0.9995</td>
<td align="right">0.0350</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2139</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-02 09:13:36</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">40.8236</td>
<td align="left">true_d13C</td>
<td align="right">1.0149</td>
<td align="right">0.0082</td>
<td align="left">***</td>
<td align="right">0.9991</td>
<td align="right">0.0661</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2140</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="left">2017-11-02 10:48:30</td>
<td align="left">yes</td>
<td align="right">2.0</td>
<td align="right">81.1947</td>
<td align="left">true_d13C</td>
<td align="right">0.9974</td>
<td align="right">0.0053</td>
<td align="left">***</td>
<td align="right">0.9996</td>
<td align="right">0.0276</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="co"># visualize the calibration coefficients</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3">stds_w_calibs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_calibration_parameters.html">iso_plot_calibration_parameters</a></span>(</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">    <span class="co"># x-axis, could also be e.g. Analysis or file_datetime (also use date_breaks!)</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6">    <span class="dt">x =</span> mean_area_identified.Vs,</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">    <span class="co"># aesthetics</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8">    <span class="dt">color =</span> seed_oxidation, <span class="dt">size =</span> mean_area_identified.Vs</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">  ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="st">  </span><span class="co"># highlight RMSD threshold (0.5 is fairly liberal, can be stricter!)</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">tibble</span>(<span class="dt">term =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="st">"RMSD"</span>), <span class="dt">threshold =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">yintercept =</span> threshold), <span class="dt">linetype =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/single_analysis_calibration_coefficients-1.png" width="672"></p>
</div>
<div id="residuals" class="section level3">
<h3 class="hasAnchor">
<a href="#residuals" class="anchor"></a>Residuals</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">stds_w_calibs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="st">  </span><span class="co"># pull out all peak data to including residuals</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/iso_unnest_data.html">iso_unnest_data</a></span>(<span class="dt">select =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/reexports">everything</a></span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="st">  </span><span class="co"># focus on standard peaks</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(is_std_peak) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="st">  </span><span class="co"># calculate parameters to visualize</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">group_by</a></span>(Analysis) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">mutate</a></span>(</a>
<a class="sourceLine" id="cb28-9" data-line-number="9">    <span class="st">`</span><span class="dt">Var: residual [permil]</span><span class="st">`</span> =<span class="st"> </span>resid,</a>
<a class="sourceLine" id="cb28-10" data-line-number="10">    <span class="st">`</span><span class="dt">Var: area diff from mean [%]</span><span class="st">`</span> =<span class="st"> </span>(area.Vs<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(area.Vs) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">ungroup</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="st">  </span><span class="co"># visualize</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb28-15" data-line-number="15">    <span class="co"># x and y </span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16">    <span class="dt">x =</span> compound, <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/reexports">starts_with</a></span>(<span class="st">"Var"</span>),</a>
<a class="sourceLine" id="cb28-17" data-line-number="17">    <span class="co"># grouping and aesthetics</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18">    <span class="dt">group =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(Analysis, calib), <span class="dt">color =</span> seed_oxidation, <span class="dt">linetype =</span> calib,</a>
<a class="sourceLine" id="cb28-19" data-line-number="19">    <span class="co"># geoms</span></a>
<a class="sourceLine" id="cb28-20" data-line-number="20">    <span class="dt">lines =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21">  )</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/single_analysis_residuals-1.png" width="672"></p>
</div>
</div>
<div id="global-calibration-with-all-standards" class="section level2">
<h2 class="hasAnchor">
<a href="#global-calibration-with-all-standards" class="anchor"></a>Global Calibration with all standards</h2>
<div id="generate-calibrations-1" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-calibrations-1" class="anchor"></a>Generate calibrations (*)</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># define a global calibration across all standards</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">global_calibs &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span>peak_table_w_stds <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">  </span><span class="co"># remove (most) problematic peaks to speed up calibration calculations</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="st">  </span><span class="co"># note: could additionally remove unidentified peaks if they are of no interest</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="../reference/iso_remove_problematic_peak_mappings.html">iso_remove_problematic_peak_mappings</a></span>(<span class="dt">remove_unidentified =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="st">  </span><span class="co"># prepare for calibration (no grouping to go across all analyses)</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="st">  </span><span class="co"># run different calibrations</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span>(</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">    <span class="dt">model =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">      <span class="dt">linear =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(d13C <span class="op">~</span><span class="st"> </span>true_d13C),</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">      <span class="dt">with_area =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(d13C <span class="op">~</span><span class="st"> </span>true_d13C <span class="op">+</span><span class="st"> </span>area.Vs),</a>
<a class="sourceLine" id="cb29-14" data-line-number="14">      <span class="dt">with_area_cross =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(d13C <span class="op">~</span><span class="st"> </span>true_d13C <span class="op">*</span><span class="st"> </span>area.Vs)</a>
<a class="sourceLine" id="cb29-15" data-line-number="15">    ),</a>
<a class="sourceLine" id="cb29-16" data-line-number="16">    <span class="co"># specify which peaks to include in the calibration, here:</span></a>
<a class="sourceLine" id="cb29-17" data-line-number="17">    <span class="co"># - all std_peaks (this filter should always be included!)</span></a>
<a class="sourceLine" id="cb29-18" data-line-number="18">    <span class="co"># - standard peaks between 5 and 100 Vs</span></a>
<a class="sourceLine" id="cb29-19" data-line-number="19">    <span class="co"># - only analyses with seed oxidation (same as all the samples)</span></a>
<a class="sourceLine" id="cb29-20" data-line-number="20">    <span class="dt">is_std_peak =</span> is_std_peak <span class="op">&amp;</span><span class="st"> </span>area.Vs <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="op">&amp;</span><span class="st"> </span>area.Vs <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span> <span class="op">&amp;</span><span class="st"> </span>seed_oxidation <span class="op">==</span><span class="st"> "yes"</span></a>
<a class="sourceLine" id="cb29-21" data-line-number="21">  )</a>
<a class="sourceLine" id="cb29-22" data-line-number="22"><span class="co">#&gt; Info: removing 7 of 628 data table entries because of problematic peak identifications (missing or ambiguous)</span></a>
<a class="sourceLine" id="cb29-23" data-line-number="23"><span class="co">#&gt; Info: preparing data for calibration by nesting the entire dataset</span></a>
<a class="sourceLine" id="cb29-24" data-line-number="24"><span class="co">#&gt; Info: generating calibration based on 3 models ('linear = lm(d13C ~ true_d13C)', 'with_area = lm(d13C ~ true_d13C + area.Vs)', 'with_area_cross = lm(d13C ~ true_d13C * area.Vs)') for 1 data group(s) with standards filter 'is_std_peak &amp; area.Vs &gt; 5 &amp; area.Vs &lt; 100 &amp; seed_oxidation == </span></a>
<a class="sourceLine" id="cb29-25" data-line-number="25"><span class="co">#&gt;     "yes"'. Storing residuals in new column 'resid'. Storing calibration info in new column 'in_calib'.</span></a></code></pre></div>
</div>
<div id="coefficients-1" class="section level3">
<h3 class="hasAnchor">
<a href="#coefficients-1" class="anchor"></a>Coefficients</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># look at coefficients and summary</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">global_calibs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span><span class="co"># unnest calibration parameters</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/iso_unnest_calibration_parameters.html">iso_unnest_calibration_parameters</a></span>(</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">    <span class="dt">select_from_coefs =</span> </a>
<a class="sourceLine" id="cb30-6" data-line-number="6">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(term, estimate, <span class="dt">SE =</span> std.error, signif),</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">    <span class="dt">select_from_summary =</span> </a>
<a class="sourceLine" id="cb30-8" data-line-number="8">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">fit_R2 =</span> adj.r.squared, <span class="dt">fit_RMSD =</span> deviance, <span class="dt">residual_df =</span> df.residual)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="../reference/iso_remove_list_columns.html">iso_remove_list_columns</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">arrange</a></span>(term) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11"><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">calib</th>
<th align="left">calib_ok</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="left">signif</th>
<th align="right">fit_R2</th>
<th align="right">fit_RMSD</th>
<th align="right">residual_df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">linear</td>
<td align="left">TRUE</td>
<td align="left">(Intercept)</td>
<td align="right">11.1100</td>
<td align="right">0.0889</td>
<td align="left">***</td>
<td align="right">0.9976</td>
<td align="right">3.6232</td>
<td align="right">298</td>
</tr>
<tr class="even">
<td align="left">with_area</td>
<td align="left">TRUE</td>
<td align="left">(Intercept)</td>
<td align="right">11.1271</td>
<td align="right">0.0882</td>
<td align="left">***</td>
<td align="right">0.9977</td>
<td align="right">3.5360</td>
<td align="right">297</td>
</tr>
<tr class="odd">
<td align="left">with_area_cross</td>
<td align="left">TRUE</td>
<td align="left">(Intercept)</td>
<td align="right">11.2339</td>
<td align="right">0.1346</td>
<td align="left">***</td>
<td align="right">0.9977</td>
<td align="right">3.5229</td>
<td align="right">296</td>
</tr>
<tr class="even">
<td align="left">with_area</td>
<td align="left">TRUE</td>
<td align="left">area.Vs</td>
<td align="right">-0.0009</td>
<td align="right">0.0003</td>
<td align="left">**</td>
<td align="right">0.9977</td>
<td align="right">3.5360</td>
<td align="right">297</td>
</tr>
<tr class="odd">
<td align="left">with_area_cross</td>
<td align="left">TRUE</td>
<td align="left">area.Vs</td>
<td align="right">-0.0058</td>
<td align="right">0.0047</td>
<td align="left">-</td>
<td align="right">0.9977</td>
<td align="right">3.5229</td>
<td align="right">296</td>
</tr>
<tr class="even">
<td align="left">linear</td>
<td align="left">TRUE</td>
<td align="left">true_d13C</td>
<td align="right">1.0075</td>
<td align="right">0.0028</td>
<td align="left">***</td>
<td align="right">0.9976</td>
<td align="right">3.6232</td>
<td align="right">298</td>
</tr>
<tr class="odd">
<td align="left">with_area</td>
<td align="left">TRUE</td>
<td align="left">true_d13C</td>
<td align="right">1.0074</td>
<td align="right">0.0028</td>
<td align="left">***</td>
<td align="right">0.9977</td>
<td align="right">3.5360</td>
<td align="right">297</td>
</tr>
<tr class="even">
<td align="left">with_area_cross</td>
<td align="left">TRUE</td>
<td align="left">true_d13C</td>
<td align="right">1.0108</td>
<td align="right">0.0043</td>
<td align="left">***</td>
<td align="right">0.9977</td>
<td align="right">3.5229</td>
<td align="right">296</td>
</tr>
<tr class="odd">
<td align="left">with_area_cross</td>
<td align="left">TRUE</td>
<td align="left">true_d13C:area.Vs</td>
<td align="right">-0.0002</td>
<td align="right">0.0002</td>
<td align="left">-</td>
<td align="right">0.9977</td>
<td align="right">3.5229</td>
<td align="right">296</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="co"># visualize coefficients for the different global calibrations</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3">global_calibs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/iso_plot_calibration_parameters.html">iso_plot_calibration_parameters</a></span>(<span class="dt">x =</span> calib, <span class="dt">color =</span> signif)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/global_calibration_coefficients-1.png" width="672"></p>
</div>
<div id="residuals-1" class="section level3">
<h3 class="hasAnchor">
<a href="#residuals-1" class="anchor"></a>Residuals</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">global_calibs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="st">  </span><span class="co"># pull out all peak data to including residuals</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/iso_unnest_data.html">iso_unnest_data</a></span>(<span class="dt">select =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/reexports">everything</a></span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="st">  </span><span class="co"># focus on standard peaks included in the calibration</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(in_calib) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="st">  </span><span class="co"># visualize</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">    <span class="co"># aesthetics</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9">    <span class="dt">x =</span> compound, <span class="dt">y =</span> resid, <span class="dt">color =</span> calib, <span class="dt">group =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(Analysis, calib),</a>
<a class="sourceLine" id="cb32-10" data-line-number="10">    <span class="co"># geoms</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11">    <span class="dt">lines =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb32-12" data-line-number="12">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-13" data-line-number="13"><span class="st">  </span><span class="co"># plot modifications</span></a>
<a class="sourceLine" id="cb32-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>calib) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/global_calibration_residuals-1.png" width="768"></p>
</div>
<div id="pick-global-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#pick-global-calibration" class="anchor"></a>Pick global calibration</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co"># which calibration to use? can include multiple if desired to see the result</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co"># in this case, the area conscious calibrations are not necessary</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3">calib_to_use &lt;-<span class="st"> "linear"</span></a></code></pre></div>
</div>
<div id="apply-global-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#apply-global-calibration" class="anchor"></a>Apply global calibration (*)</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># note that depending on the number of data points, this may take a while</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="co"># for faster calculations, chose calculate_error = FALSE</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3">global_calibs_applied &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="st">  </span>global_calibs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="st">  </span><span class="co"># decide which calibration to apply based on </span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(calib <span class="op">%in%</span><span class="st"> </span>calib_to_use) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="st">  </span><span class="co"># apply calibration indication what should be calcculated</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="../reference/iso_apply_calibration.html">iso_apply_calibration</a></span>(true_d13C, <span class="dt">calculate_error =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-9" data-line-number="9"><span class="co">#&gt; Info: applying calibration to infer 'true_d13C' for 1 data group(s); storing resulting value in new column 'true_d13C_pred' and estimated error in new column 'true_d13C_pred_se'. This may take a moment... finished.</span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10"></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="co"># calibration ranges</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12">global_calibs_with_ranges &lt;-</a>
<a class="sourceLine" id="cb34-13" data-line-number="13"><span class="st">  </span>global_calibs_applied <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14"><span class="st">  </span><span class="co"># evaluate calibration range for the measured area.Vs and predicted d13C</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="../reference/iso_evaluate_calibration_range.html">iso_evaluate_calibration_range</a></span>(area.Vs, true_d13C_pred) </a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="co">#&gt; Info: evaluating range for terms 'area.Vs' and 'true_d13C_pred' in calibration for 1 data group(s); storing resulting summary for each data entry in new column 'in_range'.</span></a>
<a class="sourceLine" id="cb34-17" data-line-number="17"></a>
<a class="sourceLine" id="cb34-18" data-line-number="18"><span class="co"># show calibration ranges</span></a>
<a class="sourceLine" id="cb34-19" data-line-number="19">global_calibs_with_ranges <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="../reference/iso_unnest_calibration_range.html">iso_unnest_calibration_range</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-21" data-line-number="21"><span class="st">  </span><span class="kw"><a href="../reference/iso_remove_list_columns.html">iso_remove_list_columns</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-22" data-line-number="22"><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">d =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">calib</th>
<th align="left">calib_ok</th>
<th align="left">term</th>
<th align="right">min</th>
<th align="right">max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">linear</td>
<td align="left">TRUE</td>
<td align="left">area.Vs</td>
<td align="right">6.71</td>
<td align="right">89.47</td>
</tr>
<tr class="even">
<td align="left">linear</td>
<td align="left">TRUE</td>
<td align="left">true_d13C_pred</td>
<td align="right">-34.10</td>
<td align="right">-25.96</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="co"># create calibrated peak table</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3">peak_table_calibrated &lt;-<span class="st"> </span>global_calibs_with_ranges <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/iso_unnest_data.html">iso_unnest_data</a></span>(<span class="dt">select =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/isoreader/topics/reexports">everything</a></span>())</a></code></pre></div>
</div>
</div>
</div>
<div id="evaluation" class="section level1">
<h1 class="hasAnchor">
<a href="#evaluation" class="anchor"></a>Evaluation</h1>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># replicate earlier overview plot but now with the calibrated delta values</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="co"># and with a higlight of the calibration ranges and which points are in range</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3">peak_table_calibrated  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="st">  </span><span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(compound)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="st">  </span><span class="co"># visualize with convenience function iso_plot_data</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">    <span class="co"># choose x and y (multiple y possible)</span></a>
<a class="sourceLine" id="cb36-9" data-line-number="9">    <span class="dt">x =</span> area.Vs, <span class="dt">y =</span> true_d13C_pred,</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">    <span class="co"># choose aesthetics</span></a>
<a class="sourceLine" id="cb36-11" data-line-number="11">    <span class="dt">color =</span> in_range, <span class="dt">shape =</span> type, <span class="dt">label =</span> compound, <span class="dt">size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb36-12" data-line-number="12">    <span class="co"># decide what geoms to include</span></a>
<a class="sourceLine" id="cb36-13" data-line-number="13">    <span class="dt">points =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb36-14" data-line-number="14">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-15" data-line-number="15"><span class="st">  </span><span class="co"># highlight calibration range</span></a>
<a class="sourceLine" id="cb36-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="../reference/iso_mark_calibration_range.html">iso_mark_calibration_range</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb36-17" data-line-number="17"><span class="st">  </span><span class="co"># further customize ggplot with a log scale x axis</span></a>
<a class="sourceLine" id="cb36-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb36-19" data-line-number="19"><span class="st">  </span><span class="co"># legend</span></a>
<a class="sourceLine" id="cb36-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>, <span class="dt">legend.direction =</span> <span class="st">"vertical"</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/data_overview-1.png" width="672"></p>
</div>
<div id="standards" class="section level2">
<h2 class="hasAnchor">
<a href="#standards" class="anchor"></a>Standards</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># visualize how standard line up after calibration</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">peak_table_calibrated <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="st">  </span><span class="co"># focus on peaks in calibration</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(in_calib) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="st">  </span><span class="co"># visualize</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">    <span class="co"># x and y</span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8">    <span class="dt">x =</span> true_d13C, <span class="dt">y =</span> true_d13C_pred, <span class="dt">y_error =</span> true_d13C_pred_se,</a>
<a class="sourceLine" id="cb37-9" data-line-number="9">    <span class="co"># aesthetics</span></a>
<a class="sourceLine" id="cb37-10" data-line-number="10">    <span class="dt">color =</span> compound, <span class="dt">size =</span> area.Vs,</a>
<a class="sourceLine" id="cb37-11" data-line-number="11">    <span class="co"># geoms</span></a>
<a class="sourceLine" id="cb37-12" data-line-number="12">    <span class="dt">points =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-14" data-line-number="14"><span class="st">  </span><span class="co"># add 1:1 trendline</span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/standards-1.png" width="672"></p>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<div id="isotopic-values" class="section level3">
<h3 class="hasAnchor">
<a href="#isotopic-values" class="anchor"></a>Isotopic values</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># Warning: data outside the calibration range MUST be taken with a big</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="co"># grain of salt, especially at the low signal area/amplitude end</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">peak_table_calibrated <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="st">  </span><span class="co"># focus on samples</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(type <span class="op">==</span><span class="st"> "sample"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="st">  </span><span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="st">  </span><span class="co"># if there's a lot of data, might need to hone in on a few at a time</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(compound)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="st">  </span><span class="co"># visualize</span></a>
<a class="sourceLine" id="cb38-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb38-11" data-line-number="11">    <span class="co"># x and y</span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12">    <span class="dt">x =</span> sample, <span class="dt">y =</span> true_d13C_pred, <span class="dt">y_error =</span> true_d13C_pred_se,</a>
<a class="sourceLine" id="cb38-13" data-line-number="13">    <span class="co"># aesthetics</span></a>
<a class="sourceLine" id="cb38-14" data-line-number="14">    <span class="dt">color =</span> in_range, <span class="dt">size =</span> rel_area,</a>
<a class="sourceLine" id="cb38-15" data-line-number="15">    <span class="co"># geoms</span></a>
<a class="sourceLine" id="cb38-16" data-line-number="16">    <span class="dt">points =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb38-17" data-line-number="17">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-18" data-line-number="18"><span class="st">  </span><span class="co"># mark calibration range (include optionally)</span></a>
<a class="sourceLine" id="cb38-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="../reference/iso_mark_calibration_range.html">iso_mark_calibration_range</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb38-20" data-line-number="20"><span class="st">  </span><span class="co"># add facet wrap</span></a>
<a class="sourceLine" id="cb38-21" data-line-number="21"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>compound, <span class="dt">scales =</span> <span class="st">"free_y"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-22" data-line-number="22"><span class="st">  </span><span class="co"># color palette (here example of manual: www.google.com/search?q=color+picker)</span></a>
<a class="sourceLine" id="cb38-23" data-line-number="23"><span class="st">  </span><span class="kw">scale_color_manual</span>(</a>
<a class="sourceLine" id="cb38-24" data-line-number="24">    <span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"#984EA3"</span>, <span class="st">"#E41A1C"</span>, <span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#FF7F00"</span>, <span class="st">"#4DAF4A"</span>)</a>
<a class="sourceLine" id="cb38-25" data-line-number="25">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-26" data-line-number="26"><span class="st">  </span><span class="co"># clarify size scale</span></a>
<a class="sourceLine" id="cb38-27" data-line-number="27"><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>), </a>
<a class="sourceLine" id="cb38-28" data-line-number="28">                        <span class="dt">labels =</span> <span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="dv">100</span><span class="op">*</span>x, <span class="st">"%"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-29" data-line-number="29"><span class="st">  </span><span class="co"># plot labels</span></a>
<a class="sourceLine" id="cb38-30" data-line-number="30"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">"d13C [permil]"</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/samples-1.png" width="960"></p>
</div>
<div id="relative-abundances" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-abundances" class="anchor"></a>Relative abundances</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># visualize relative abundances</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">peak_table_calibrated <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">  </span><span class="co"># focus on samples</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(type <span class="op">==</span><span class="st"> "sample"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="st">  </span><span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="st">  </span><span class="co">#filter(!is.na(compound)) %&gt;% </span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="st">  </span><span class="co"># visualize</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span>(</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">    <span class="co"># x and y</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10">    <span class="dt">x =</span> sample, <span class="dt">y =</span> rel_area,</a>
<a class="sourceLine" id="cb39-11" data-line-number="11">    <span class="co"># aesthetics</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12">    <span class="dt">fill =</span> compound</a>
<a class="sourceLine" id="cb39-13" data-line-number="13">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="st">  </span><span class="co"># barchart</span></a>
<a class="sourceLine" id="cb39-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="st">  </span><span class="co"># scales</span></a>
<a class="sourceLine" id="cb39-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> <span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="dv">100</span><span class="op">*</span>x, <span class="st">"%"</span>), <span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-18" data-line-number="18"><span class="st">  </span><span class="co"># plot labels</span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">"Relative abundance (by area)"</span>)</a></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/abundances-1.png" width="672"></p>
</div>
<div id="summary-2" class="section level3">
<h3 class="hasAnchor">
<a href="#summary-2" class="anchor"></a>Summary</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># generate data summary</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">peak_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="st">  </span>peak_table_calibrated <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="st">  </span><span class="co"># focus on identified peaks in the samples</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(type <span class="op">==</span><span class="st"> "sample"</span>, <span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(compound)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">select</a></span>(sample, compound, Analysis, </a>
<a class="sourceLine" id="cb40-7" data-line-number="7">         area.Vs, true_d13C_pred, true_d13C_pred_se, in_range) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">arrange</a></span>(sample, compound, Analysis)</a>
<a class="sourceLine" id="cb40-9" data-line-number="9"></a>
<a class="sourceLine" id="cb40-10" data-line-number="10"><span class="co"># summarize replicates</span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="co"># this example data set does not contain any replicates but typically all</span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12"><span class="co"># analyses should in which case a statistical data summary can be useful</span></a>
<a class="sourceLine" id="cb40-13" data-line-number="13">peak_data_summary &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb40-14" data-line-number="14"><span class="st">  </span>peak_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-15" data-line-number="15"><span class="st">  </span><span class="co"># here: only peaks within the area calibration range are included</span></a>
<a class="sourceLine" id="cb40-16" data-line-number="16"><span class="st">  </span><span class="co"># you have to explicitly decide which peaks you trust if they are out of range</span></a>
<a class="sourceLine" id="cb40-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(</a>
<a class="sourceLine" id="cb40-18" data-line-number="18">    in_range <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"in range"</span>, <span class="st">"&lt;'true_d13C_pred' range"</span>, <span class="st">"&gt;'true_d13C_pred' range"</span>)</a>
<a class="sourceLine" id="cb40-19" data-line-number="19">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-20" data-line-number="20"><span class="st">  </span><span class="co"># summarize for each sample and compound</span></a>
<a class="sourceLine" id="cb40-21" data-line-number="21"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/plotly/topics/reexports">group_by</a></span>(sample, compound) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="../reference/iso_summarize_data_table.html">iso_summarize_data_table</a></span>(area.Vs, true_d13C_pred)</a>
<a class="sourceLine" id="cb40-23" data-line-number="23"></a>
<a class="sourceLine" id="cb40-24" data-line-number="24">peak_data_summary <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">d =</span> <span class="dv">12</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">sample</th>
<th align="left">compound</th>
<th align="right">n</th>
<th align="right">area.Vs mean</th>
<th align="right">area.Vs sd</th>
<th align="right">true_d13C_pred mean</th>
<th align="right">true_d13C_pred sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC22</td>
<td align="right">1</td>
<td align="right">14.602483</td>
<td align="right">NA</td>
<td align="right">-28.47688</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC24</td>
<td align="right">1</td>
<td align="right">20.298511</td>
<td align="right">NA</td>
<td align="right">-28.23445</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC25</td>
<td align="right">1</td>
<td align="right">32.690922</td>
<td align="right">NA</td>
<td align="right">-27.10697</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">64.378921</td>
<td align="right">NA</td>
<td align="right">-27.79953</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC28</td>
<td align="right">1</td>
<td align="right">31.016645</td>
<td align="right">NA</td>
<td align="right">-29.05930</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">47.434167</td>
<td align="right">NA</td>
<td align="right">-29.43559</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC30</td>
<td align="right">1</td>
<td align="right">25.782745</td>
<td align="right">NA</td>
<td align="right">-30.80960</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">14.992096</td>
<td align="right">NA</td>
<td align="right">-33.13507</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Niwot_Tundra1</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">8.374856</td>
<td align="right">NA</td>
<td align="right">-31.83629</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Niwot_Tundra1</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">26.445142</td>
<td align="right">NA</td>
<td align="right">-31.65569</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Niwot_Tundra1</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">16.122148</td>
<td align="right">NA</td>
<td align="right">-31.78948</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Niwot_Tundra2</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">10.308102</td>
<td align="right">NA</td>
<td align="right">-31.74712</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Niwot_Tundra2</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">34.199716</td>
<td align="right">NA</td>
<td align="right">-31.58585</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Niwot_Tundra2</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">16.153033</td>
<td align="right">NA</td>
<td align="right">-31.85476</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">SJER</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">10.255800</td>
<td align="right">NA</td>
<td align="right">-36.49165</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">SJER</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">24.276302</td>
<td align="right">NA</td>
<td align="right">-36.48772</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">SJER</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">48.444256</td>
<td align="right">NA</td>
<td align="right">-38.30051</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="final" class="section level1">
<h1 class="hasAnchor">
<a href="#final" class="anchor"></a>Final</h1>
<p>Final data processing and visualization usually depends on the type of data and the metadata available for contextualization (e.g. core depth, source organism, age, etc.). The relevant metadata can be added easily with <code>iso_add_file_info()</code> during the initial data load / file info procesing. Alternatively, just call <code>iso_add_file_info()</code> again at this later point or use dplyr’s <code>left_join</code> directly.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># @user: add final data processing and plot(s)</span></a></code></pre></div>
</div>
<div id="export" class="section level1">
<h1 class="hasAnchor">
<a href="#export" class="anchor"></a>Export</h1>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># export the global calibration with all its information and data to Excel</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">global_calibs_with_ranges <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/iso_export_calibration_to_excel.html">iso_export_calibration_to_excel</a></span>(</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">    <span class="dt">filepath =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(), <span class="st">"%Y%m%d_gc_irms_example_carbon_export.xlsx"</span>),</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">    <span class="co"># include data summary as an additional useful tab</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6">    <span class="st">`</span><span class="dt">data summary</span><span class="st">`</span> =<span class="st"> </span>peak_data_summary</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="co">#&gt; Info: exporting calibrations into Excel '20190529_gc_irms_example_carbon_export.xlsx'... Note: zip::zip() is deprecated, please use zip::zipr() instead</span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9"><span class="co">#&gt; complete. Created tabs 'data summary', 'all data', 'calib coefs', 'calib summary' and 'calib range'.</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-packages">Load packages</a></li>
      <li>
<a href="#load-data">Load data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#read-raw-data-files">Read raw data files (*)</a></li>
      <li><a href="#process-file-information">Process file information (*)</a></li>
      <li><a href="#show-file-information">Show file information</a></li>
      <li><a href="#example-chromatograms">Example chromatograms</a></li>
      </ul>
</li>
      <li>
<a href="#onoffs">ON/OFFs</a><ul class="nav nav-pills nav-stacked">
<li><a href="#summary">Summary</a></li>
      </ul>
</li>
      <li>
<a href="#linearity">Linearity</a><ul class="nav nav-pills nav-stacked">
<li><a href="#summary-1">Summary</a></li>
      </ul>
</li>
      <li><a href="#data-table">Data table (*)</a></li>
      <li>
<a href="#peak-identification">Peak Identification</a><ul class="nav nav-pills nav-stacked">
<li><a href="#load-peak-maps">Load peak maps</a></li>
      <li><a href="#identify-peaks">Identify peaks (*)</a></li>
      <li><a href="#inspect-peak-mappings">Inspect peak mappings</a></li>
      <li><a href="#overview-of-unclear-peak-mappings">Overview of unclear peak mappings</a></li>
      </ul>
</li>
      <li><a href="#reference-peaks">Reference peaks</a></li>
      <li>
<a href="#analyte-peaks">Analyte peaks</a><ul class="nav nav-pills nav-stacked">
<li><a href="#select-analyte-peaks">Select analyte peaks (*)</a></li>
      <li><a href="#first-look">First look</a></li>
      <li><a href="#optionally---use-interactive-plot">Optionally - use interactive plot</a></li>
      <li><a href="#evaluate-signal-yield">Evaluate signal yield</a></li>
      </ul>
</li>
      <li>
<a href="#isotope-standard-values">Isotope standard values</a><ul class="nav nav-pills nav-stacked">
<li><a href="#load-isotope-standards">Load isotope standards</a></li>
      <li><a href="#add-isotope-standards">Add isotope standards (*)</a></li>
      </ul>
</li>
      <li>
<a href="#calibration">Calibration</a><ul class="nav nav-pills nav-stacked">
<li><a href="#single-analysis-calibration-for-qa">Single analysis calibration (for QA)</a></li>
      <li><a href="#global-calibration-with-all-standards">Global Calibration with all standards</a></li>
      </ul>
</li>
      <li>
<a href="#evaluation">Evaluation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#standards">Standards</a></li>
      <li><a href="#data">Data</a></li>
      </ul>
</li>
      <li><a href="#final">Final</a></li>
      <li><a href="#export">Export</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
